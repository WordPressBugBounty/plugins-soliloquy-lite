jQuery(document).ready(function(o){o("a.soliloquy-slides-delete").click(function(e){if(e.preventDefault(),!confirm(soliloquy_metabox_local.remove_multiple))return!1;var t=[],e=(o("ul#soliloquy-output > li.selected").each(function(){t.push(o(this).attr("id"))}),{action:"soliloquy_remove_slides",attachment_ids:t,post_id:soliloquy_metabox_local.id,nonce:soliloquy_metabox_local.remove_nonce});o.post(soliloquy_metabox_local.ajax,e,function(e){o("ul#soliloquy-output > li.selected").remove(),o(".soliloquy-bulk-actions").fadeOut(),o(".soliloquy-select-all").prop("checked",!1),o(".soliloquy-load-library").attr("data-soliloquy-offset",0).addClass("has-search").trigger("click"),SoliloquySlidesUpdate(!1);var t=o("#soliloquy-output li").length;o(".soliloquy-count").text(t.toString()),0===t&&(o(".soliloquy-bulk-actions").fadeOut(),o(".soliloquy-slide-header").fadeOut().addClass("soliloquy-hidden"),o("#soliloquy-empty-slider").removeClass("soliloquy-hidden").fadeIn())},"json")}),o("#soliloquy-settings-content ").on("click",".soliloquy-remove-slide",function(e){var t;e.preventDefault(),confirm(soliloquy_metabox_local.remove)&&(e={action:"soliloquy_remove_slide",attachment_id:t=o(this).parent().attr("id"),post_id:soliloquy_metabox_local.id,nonce:soliloquy_metabox_local.remove_nonce},o.post(soliloquy_metabox_local.ajax,e,function(e){o("#"+t).fadeOut("normal",function(){o(this).remove(),o(".soliloquy-load-library").attr("data-soliloquy-offset",0).addClass("has-search").trigger("click"),SoliloquySlidesUpdate(!1);var e=o("#soliloquy-output li").length;o(".soliloquy-count").text(e.toString()),0===e&&(o(".soliloquy-bulk-actions").fadeOut(),o(".soliloquy-slide-header").fadeOut().addClass("soliloquy-hidden"),o("#soliloquy-empty-slider").removeClass("soliloquy-hidden").fadeIn())})},"json"))})});var SoliloquySlide=Backbone.Model.extend({defaults:{id:"",title:"",caption:"",alt:"",link:"",type:""}}),SoliloquySlides=new Backbone.Collection,SoliloquyModalWindow=new wp.media.view.Modal({controller:{trigger:function(){}}}),SoliloquyView=wp.Backbone.View.extend({id:"soliloquy-meta-edit",tagName:"div",className:"edit-attachment-frame mode-select hide-menu hide-router",template:wp.template("soliloquy-meta-editor"),events:{"click .edit-media-header .left":"loadPreviousItem","click .edit-media-header .right":"loadNextItem","keyup input":"updateItem","keyup textarea":"updateItem","change input":"updateItem","change textarea":"updateItem","keyup .CodeMirror":"updateCode","blur textarea":"updateItem","change select":"updateItem","click a.soliloquy-meta-submit":"saveItem","keyup input#link-search":"searchLinks","click div.query-results li":"insertLink","click a.soliloquy-thumbnail":"insertThumb","click a.soliloquy-thumbnail-delete":"removeThumb","click button.media-file":"insertMediaFileLink","click button.attachment-page":"insertAttachmentPageLink"},initialize:function(e){this.is_loading=!1,this.collection=e.collection,this.child_views=e.child_views,this.attachment_id=e.attachment_id,this.attachment_index=0,this.search_timer="";var t=0;this.collection.each(function(e){if(String(e.get("id"))==String(this.attachment_id))return this.model=e,this.attachment_index=t,!1;t++},this)},updateCode:function(e){$model=this.model,$textarea=this.$el.find(".soliloquy-html-slide-code"),$model.set("code",this.editor.getValue(),{silent:!0}),$textarea.text()},insertThumb:function(e){$model=this.model,e.preventDefault();this.$el.data("field");var t=wp.media.frames.soliloquy_media_frame=wp.media({className:"media-frame soliloquy-media-frame",frame:"select",multiple:!1,title:soliloquy_metabox_local.videoframe,library:{type:"image"},button:{text:soliloquy_metabox_local.videouse}});t.on("select",function(){var e=t.state().get("selection").first().toJSON();$model.set("src",e.url,{silent:!0}),jQuery("div.thumbnail > img",$parent.find(".media-frame-content")).attr("src",e.url)}),t.open()},removeThumb:function(e){e.preventDefault(),$model=this.model,$parent=this.$el.parent(),jQuery("div.thumbnail > img",$parent.find(".media-frame-content")).attr("src",""),$model.set("src","",{silent:!0})},render:function(){return this.$el.html(this.template(this.model.attributes)),0<this.child_views.length&&this.child_views.forEach(function(e){e=new e({model:this.model});this.$el.find("div.addons").append(e.render().el)},this),this.$el.find("textarea[name=caption]").val(this.model.get("caption")),setTimeout(function(){quicktags({id:"caption",buttons:"strong,em,link,ul,ol,li,close"}),QTags._buttonsInit()},500),wpLink.init,0===this.attachment_index&&this.$el.find("button.left").addClass("disabled"),this.attachment_index==this.collection.length-1&&this.$el.find("button.right").addClass("disabled"),(textarea=this.$el.find(".soliloquy-html-slide-code")).length&&(this.editor=CodeMirror.fromTextArea(textarea[0],{enterMode:"keep",indentUnit:4,electricChars:!1,lineNumbers:!0,lineWrapping:!0,matchBrackets:!0,mode:"php",smartIndent:!1,tabMode:"shift",theme:"ttcn"})),this.$el.trigger("soliloquyRenderMeta"),this},loading:function(){this.is_loading=!0,this.$el.find(".spinner").css("visibility","visible")},loaded:function(e){this.is_loading=!1,this.$el.find(".spinner").css("visibility","hidden"),void 0!==e&&alert(e)},loadPreviousItem:function(){this.attachment_index--,this.model=this.collection.at(this.attachment_index),this.attachment_id=this.model.get("id"),this.render()},loadNextItem:function(){this.attachment_index++,this.model=this.collection.at(this.attachment_index),this.attachment_id=this.model.get("id"),this.render()},updateItem:function(e){""!=e.target.name&&(value="checkbox"==e.target.type?e.target.checked?1:0:e.target.value,this.model.set(e.target.name,value))},saveItem:function(e){e.preventDefault(),this.trigger("loading"),wp.media.ajax("soliloquy_save_meta",{context:this,data:{nonce:soliloquy_metabox_local.save_nonce,post_id:soliloquy_metabox_local.id,attach_id:this.model.get("id"),meta:this.model.attributes},success:function(e){this.trigger("loaded loaded:success");var t=JSON.stringify(this.model.attributes),o=(jQuery("ul#soliloquy-output li#"+this.model.get("id")).attr("data-soliloquy-image-model",t),this.$el.find(".saved"));o.fadeIn(),setTimeout(function(){o.fadeOut()},1500)},error:function(e){this.trigger("loaded loaded:error",e)}})},searchLinks:function(e){},insertLink:function(e){},insertMediaFileLink:function(e){this.trigger("loading"),wp.media.ajax("soliloquy_get_attachment_links",{context:this,data:{nonce:soliloquy_metabox_local.save_nonce,attachment_id:this.model.get("id")},success:function(e){this.model.set("link",e.media_link),this.trigger("loaded loaded:success"),this.render()},error:function(e){this.trigger("loaded loaded:error",e)}})},insertAttachmentPageLink:function(e){this.trigger("loading"),wp.media.ajax("soliloquy_get_attachment_links",{context:this,data:{nonce:soliloquy_metabox_local.save_nonce,attachment_id:this.model.get("id")},success:function(e){this.model.set("link",e.attachment_page),this.trigger("loaded loaded:success"),this.render()},error:function(e){this.trigger("loaded loaded:error",e)}})}}),SoliloquyChildViews=[],SoliloquyContentViews=[];function SoliloquySlidesUpdate(e){SoliloquySlides.reset(),jQuery("ul#soliloquy-output li.soliloquy-slide"+(e?".selected":"")).each(function(){var e=jQuery.parseJSON(jQuery(this).attr("data-soliloquy-image-model"));SoliloquySlides.add(new SoliloquySlide(e))})}(t=>{t(document).ready(function(){(soliloquy_edit={init:function(){SoliloquySlidesUpdate(),t("#soliloquy-settings-content").on("click.soliloquyModify",".soliloquy-modify-slide",function(e){e.preventDefault();e=t(this).parent().data("soliloquy-slide");SoliloquyModalWindow.content(new SoliloquyView({collection:SoliloquySlides,child_views:SoliloquyChildViews,attachment_id:e})),SoliloquyModalWindow.open(),t(document).trigger("soliloquyEditOpen"),t(".CodeMirror").each(function(e,t){t.CodeMirror.refresh()})})}}).init()}),t(document).on("soliloquyUploaded",function(){soliloquy_edit.init()})})(jQuery),jQuery(document).ready(function(o){o("a.soliloquy-media-library").on("click",function(e){e.preventDefault(),wp.media.frames.soliloquy?wp.media.frames.soliloquy.open():(wp.media.frames.soliloquy=new wp.media.view.MediaFrame.Post({title:wp.media.view.l10n.insertIntoPost,button:{text:wp.media.view.l10n.insertIntoPost},multiple:!0,library:{type:"image"}}),wp.media.frames.soliloquy.on("open",function(){var t=wp.media.frames.soliloquy.state().get("selection");o("ul#soliloquy-output li").each(function(){var e=wp.media.attachment(o(this).attr("id"));t.add(e?[e]:[])})}),wp.media.frames.soliloquy.on("ready",function(){}),wp.media.frames.soliloquy.on("insert",function(e){var i=wp.media.frames.soliloquy.state(),l=[];e.each(function(e){var t=i.display(e).toJSON(),o=e.get("type");switch(t.link){case"none":e.set("link","");break;case"file":e.set("link",e.get("url"));break;case"post":break;case"custom":e.set("link",t.linkUrl)}"image"===o&&l.push(e.toJSON())},this),o.post(soliloquy_metabox_local.ajax,{action:"soliloquy_insert_slides",nonce:soliloquy_metabox_local.insert_nonce,post_id:soliloquy_metabox_local.id,images:JSON.stringify(l)},function(e){e&&(o("#soliloquy-output").html(e.data),SoliloquySlidesUpdate(),e=o("#soliloquy-output li").length,o(".soliloquy-count").text(e.toString()),0<e)&&(o("#soliloquy-empty-slider").fadeOut().addClass("soliloquy-hidden"),o(".soliloquy-slide-header").removeClass("soliloquy-hidden").fadeIn(),o(".soliloquy-bulk-actions").fadeOut())},"json")}),wp.media.frames.soliloquy.open(),o("div.media-menu a.media-menu-item:nth-child(2)").addClass("hidden"),o("div.media-menu a.media-menu-item:nth-child(3)").addClass("hidden"),o("div.media-menu a.media-menu-item:nth-child(4)").addClass("hidden"),o("div.media-menu a.media-menu-item:nth-child(6)").addClass("hidden"))})}),((d,e,u)=>{var t={init:function(){this.select_all(),this.sortable(),this.select(),this.display(),this.chosen(),this.slide_size(),this.uploadImage(),this.toggleStatus(),this.tooltip(),this.clear_selected(),new Clipboard(".soliloquy-clipboard"),d("ul#soliloquy-output").on("click","a.check",function(e){e.preventDefault()}),d(".soliloquy-clipboard").on("click",function(e){e.preventDefault()});var e=d("#soliloquy-output li").length;d(".soliloquy-count").text(e.toString()),d("input,select").conditional()},toggleStatus:function(){d("#soliloquy-settings-content").on("click.soliloquyStatus",".soliloquy-slide-status",function(e){var t="",o="",e=(e.preventDefault(),t=(d(this).hasClass("list-status")?d(this).parent().parent():d(this)).parent(),d(this)),i=e.data("status"),l=t.find(".soliloquy-slide-status.list-status"),a=t.find(".soliloquy-slide-status.grid-status"),t=(e.parent().parent().data("view"),e.data("id")),s=a.find("span.dashicons"),n=l.find("span"),o=(e.data("soliloquy-tooltip"),"active"===i?"pending":"active"),e={url:u.ajax,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"soliloquy_change_slide_status",post_id:u.id,slide_id:t,status:o,nonce:u.save_nonce},success:function(e){"active"===o?(a.removeClass("soliloquy-draft-slide").addClass("soliloquy-active-slide"),l.removeClass("soliloquy-draft-slide").addClass("soliloquy-active-slide"),s.removeClass("dashicons-hidden").addClass("dashicons-visibility"),n.text(u.active),a.attr("data-soliloquy-tooltip",u.active),l.data("status","active"),a.data("status","active")):(a.removeClass("soliloquy-active-slide").addClass("soliloquy-draft-slide"),l.removeClass("soliloquy-active-slide").addClass("soliloquy-draft-slide"),s.removeClass("dashicons-visibility").addClass("dashicons-hidden"),n.text(u.draft),l.data("status","pending"),a.data("status","pending"),a.attr("data-soliloquy-tooltip",u.draft))},error:function(e,t,o){}};d.ajax(e)})},tooltip:function(){d("[data-soliloquy-tooltip]").on("mouseover",function(e){e.preventDefault();d(this).data("soliloquy-tooltip")})},select_all:function(){d(".soliloquy-select-all").change(function(){var e;this.checked?(d("ul#soliloquy-output li").addClass("selected"),d(".soliloquy-bulk-actions").fadeIn(),e=d("ul#soliloquy-output li.selected").length,d(".select-all").text(u.selected),d(".soliloquy-count").text(e.toString()),d(".soliloquy-clear-selected").fadeIn()):(d("ul#soliloquy-output li").removeClass("selected"),d(".soliloquy-bulk-actions").fadeOut(),e=d("ul#soliloquy-output li").length,d(".select-all").text(u.select_all),d(".soliloquy-count").text(e.toString()),d(".soliloquy-clear-selected").fadeOut())})},sortable:function(){var i=d("#soliloquy-output");i.sortable({containment:"#soliloquy-slider-main",items:"li",cursor:"move",forcePlaceholderSize:!0,placeholder:"dropzone",update:function(e,t){var o={url:u.ajax,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"soliloquy_sort_images",order:i.sortable("toArray").toString(),post_id:u.id,nonce:u.sort},success:function(e){SoliloquySlidesUpdate()},error:function(e,t,o){}};d.ajax(o)}})},select:function(){var s=!1,n=!1;d("li.soliloquy-slide .soliloquy-item-content, .soliloquy-list li a.check").on("click",function(e){d(this);var t,o=d(this).parent();if(e.preventDefault(),d(o).hasClass("selected"))d(o).removeClass("selected"),n=!1,0!==(t=d("ul#soliloquy-output li.selected").length)?(d(".select-all").text(u.selected),d(".soliloquy-count").text(t.toString()),d(".soliloquy-clear-selected").fadeIn()):(e=d("ul#soliloquy-output li").length,d(".select-all").text(u.select_all),d(".soliloquy-count").text(e.toString()),d(".soliloquy-clear-selected").fadeOut());else{if(s&&!1!==n){var i=d("ul#soliloquy-output li").index(d(n)),l=d("ul#soliloquy-output li").index(d(o)),a=0;if(i<l)for(a=i;a<=l;a++)d("ul#soliloquy-output li:eq( "+a+")").addClass("selected");else for(a=l;a<=i;a++)d("ul#soliloquy-output li:eq( "+a+")").addClass("selected")}d(o).addClass("selected"),n=d(o),t=d("ul#soliloquy-output li.selected").length,d(".soliloquy-clear-selected").fadeIn(),d(".select-all").text(u.selected),d(".soliloquy-count").text(t.toString())}0<d("ul#soliloquy-output > li.selected").length?d(".soliloquy-bulk-actions").fadeIn():d(".soliloquy-bulk-actions").fadeOut()}),d(e).on("keyup keydown",function(e){s=e.shiftKey})},slide_size:function(){d(e).on("change","#soliloquy-config-slider-size",function(){var e=d(this),t=e.val(),o=e.find(":selected").data("soliloquy-width"),e=e.find(":selected").data("soliloquy-height");"default"==t&&(d("#soliloquy-config-slider-width").val(u.slide_width),d("#soliloquy-config-slider-height").val(u.slide_height)),o&&d("#soliloquy-config-slider-width").val(o),e&&d("#soliloquy-config-slider-height").val(e)})},clear_selected:function(){d(".soliloquy-clear-selected").on("click",function(e){e.preventDefault();e=d("#soliloquy-output li").length;d("ul#soliloquy-output li").removeClass("selected"),d(".select-all").text(u.select_all),d(".soliloquy-count").text(e.toString()),d(".soliloquy-select-all").prop("checked",!1),d(".soliloquy-bulk-actions").fadeOut(),d(this).fadeOut()})},display:function(){d("a.soliloquy-display").on("click",function(e){var t,o,i;e.preventDefault(),d(this).hasClass("active-display")||(t=(e=d(this)).data("soliloquy-display"),o=d("#soliloquy-output"),i={url:u.ajax,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"soliloquy_slider_view",post_id:u.id,view:t,nonce:u.save_nonce},success:function(e){}},d.ajax(i),d(".soliloquy-display-toggle").find(".active-display").removeClass("active-display"),e.addClass("active-display"),"grid"===t?o.removeClass("soliloquy-list").addClass("soliloquy-grid"):"list"===t&&o.removeClass("soliloquy-grid").addClass("soliloquy-list"))})},chosen:function(){d(".soliloquy-chosen").each(function(){var e=d(this).data("soliloquy-chosen-options");d(this).chosen(e)})},uploadImage:function(){d(".soliloquy-insert-image").on("click",function(e){e.preventDefault();var t,o=d(event.currentTarget).parent().find("input");(t=wp.media.frames.soliloquy_image_frame=wp.media({frame:"select",library:{type:"image"},title:u.insert_image,button:{text:u.insert_image},contentUserSetting:!1,multiple:!1})).on("select",function(){var e=t.state().get("selection").first().toJSON();o.val(e.url)}),t.open()})}};d(function(){t.init()}),d(e).on("soliloquyType",function(){t.init()})})(jQuery,(window,document),soliloquy_metabox_local),((a,s,n)=>{a(function(){var o,i,l;"undefined"!=typeof uploader&&(a("input#plupload-browse-button").val(n.uploader_files_computer),a(".drag-drop-info").text(n.uploader_info_text),a("#soliloquy .drag-drop-inside").append('<div class="soliloquy-progress-bar"><div></div></div>'),o=a("#soliloquy .soliloquy-progress-bar"),i=a("#soliloquy .soliloquy-progress-bar div"),l=a("#soliloquy-output"),uploader.bind("FilesAdded",function(e,t){e.files=t,a(o).fadeIn()}),uploader.bind("BeforeUpload",function(e,t){if(t.name.toLowerCase().endsWith(".heic")&&!n.is_imagick_enabled)return a("#soliloquy-upload-error").html(`<div class="error fade"><p>${n.heic_error_text}</p></div>`),!1}),uploader.bind("UploadProgress",function(e,t){a(i).css({width:e.total.percent+"%"})}),uploader.bind("FileUploaded",function(e,t,o){a.post(n.ajax,{action:"soliloquy_load_image",nonce:n.load_image,id:o.response,post_id:n.id},function(e){"before"===n.media_position?a(l).prepend(e):a(l).append(e),a(s).trigger("soliloquyUploaded"),a(e).find(".wp-editor-container").each(function(e,t){t=a(t).attr("id").split("-")[4];quicktags({id:"soliloquy-caption-"+t,buttons:"strong,em,link,ul,ol,li,close"}),QTags._buttonsInit()}),a(s).trigger("insertSlides")},"json")}),uploader.bind("UploadComplete",function(){a(o).fadeOut()}),uploader.bind("Error",function(e,t){a("#soliloquy-upload-error").html('<div class="error fade"><p>'+t.file.name+": "+t.message+"</p></div>"),e.refresh()}))})})(jQuery,(window,document),soliloquy_media_uploader),((s,n)=>{var e,t,o,i=n.location.hash,l=n.location.hash.replace("!","");i&&0<=i.indexOf("soliloquy-tab")&&(e=(i=s(l.replace("tab_",""))).parent(),t=i.parent().parent().find("ul.soliloquy-tabs-nav"),o=s("#post").attr("action"),e.find(".soliloquy-tab-active").removeClass("soliloquy-tab-active"),i.addClass("soliloquy-tab-active"),t.find(".soliloquy-tab-nav-active").removeClass("soliloquy-tab-nav-active"),t.find('a[href="'+l.replace("tab_","")+'"]').parent().addClass("soliloquy-tab-nav-active"),o&&(o=o.split("#")[0],s("#post").attr("action",o+n.location.hash)),s("body").trigger("SoliloquyTabChange")),s(function(){s("[data-soliloquy-tab]").on("click",function(e){e.preventDefault();var e=s(this),t=e.attr("data-tab-id"),o=e.parent(),i=o.parent(),l=o.attr("data-update-hashbang"),a=void 0!==e.attr("href")?"tab_"+e.attr("href"):"tab_"+t;if(!e.hasClass("soliloquy-tab-nav-active"))return i.find(".soliloquy-tab-active").removeClass("soliloquy-tab-active"),o.find(".soliloquy-tab-nav-active").removeClass("soliloquy-tab-nav-active"),e.addClass("soliloquy-tab-nav-active"),s("#"+t).addClass("soliloquy-tab-active"),e.trigger("SoliloquyTabChange"),"soliloquy-native"===t&&!0!==s("#soliloquy-type-default").prop("checked")&&(s("#soliloquy-types-nav li").removeClass("soliloquy-active"),s("#soliloquy-type-default").prop("checked",!0).trigger("change")),"1"===l&&(n.location.hash=a.split("#").join("#!"),i=s("#post").attr("action"))&&(i=i.split("#")[0],s("#post").attr("action",i+n.location.hash)),!1})})})(jQuery,window,document),((a,s,t)=>{a(function(){var o=a("#soliloquy-tabs"),i=a("#soliloquy-tabs-nav"),l=s.location.hash,e=s.location.hash.replace("!","");l&&0<=l.indexOf("soliloquy-tab-")&&(a(".soliloquy-active").removeClass("soliloquy-active nav-tab-active"),i.find('a[href="'+e+'"]').addClass("soliloquy-active nav-tab-active"),o.find(e).addClass("soliloquy-active").show()),a(".soliloquy-start-upgrade").on("click",function(e){e.preventDefault();a(this);a(".soliloquy-spinner").css({display:"inline-block",float:"none","vertical-align":"text-bottom"});e={action:"soliloquy_upgrade_sliders",nonce:t.upgrade_nonce};a.post(t.ajax,e,function(e){a(".soliloquy-spinner").hide(),s.location.replace(t.redirect)},"json")}),a("#soliloquy-tabs-nav a").on("click",function(e){e.preventDefault();var t,e=a(this);e.hasClass("soliloquy-active")||(s.location.hash=l=this.hash.split("#").join("#!"),t=i.find(".soliloquy-active").removeClass("soliloquy-active nav-tab-active").attr("href"),e.addClass("soliloquy-active nav-tab-active"),o.find(t).removeClass("soliloquy-active").hide(),o.find(e.attr("href")).addClass("soliloquy-active").show())}),a(".soliloquy-chosen").each(function(){var e=a(this).data("soliloquy-chosen-options");a(this).chosen(e)})})})(jQuery,window,(document,soliloquy_settings)),((u,r)=>{u(function(){u(".soliloquy-chosen").each(function(){u(this).chosen({disable_search:!0})}),u("#soliloquy-addon-filter").on("change",function(){var e=u(this).val(),o=u("#soliloquy-addons-area"),t=(o.data("soliloquy-filter"),u("#soliloquy-addons-area .soliloquy-addon"));switch(t.show(),e){case"asc":t.sort(function(e,t){return u(e).data("addon-title").localeCompare(u(t).data("addon-title"))}).each(function(e,t){u(t).removeClass("last"),o.append(t).hide().fadeIn(100)}),u("#soliloquy-addons-area .soliloquy-addon:nth-child(3n)").addClass("last");break;case"desc":t.sort(function(e,t){return u(t).data("addon-title").localeCompare(u(e).data("addon-title"))}).each(function(e,t){u(t).removeClass("last"),o.append(t).hide().fadeIn(100)}),u("#soliloquy-addons-area .soliloquy-addon:nth-child(3n)").addClass("last");break;case"active":t.hide().filter('[data-addon-status="active"]').show(),t.removeClass("last"),u("#soliloquy-addons-area .soliloquy-addon:visible").each(function(e){(e+1)%3==0&&u(this).addClass("last")});break;case"inactive":t.hide().filter('[data-addon-status="inactive"]').show(),t.removeClass("last"),u("#soliloquy-addons-area .soliloquy-addon:visible").each(function(e){(e+1)%3==0&&u(this).addClass("last")});break;case"installed":t.hide().filter('[data-addon-status="not_installed"]').show(),t.removeClass("last"),u("#soliloquy-addons-area .soliloquy-addon:visible").each(function(e){(e+1)%3==0&&u(this).addClass("last")})}}),u("#soliloquy-addons-area").on("click.refreshInstallAddon",".soliloquy-addon-action-button",function(e){e.preventDefault();var o=u(this),e=u("#soliloquy-addons-area").find(".soliloquy-addon-action-button");u.each(e,function(e,t){if(o===t)return!0;u(t).attr("disabled")&&u(t).removeAttr("disabled"),u(t).parent().parent().hasClass("soliloquy-addon-not-installed")&&u(t).text(r.install)})}),u("#soliloquy-addons-area").on("click.activateAddon",".soliloquy-activate-addon",function(e){e.preventDefault();var i=u(this),e=i.attr("rel"),t=i.parent().parent(),o=i.parent().parent().find(".addon-status").children("span"),e=(u(".soliloquy-addon-error").remove(),i.text(r.activating),i.next().css({display:"inline-block","margin-top":"0px"}),{url:ajaxurl,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"soliloquy_activate_addon",nonce:r.activate_nonce,plugin:e},success:function(e){e&&!0!==e?t.slideDown("normal",function(){u(this).after('<div class="soliloquy-addon-error"><strong>'+e.error+"</strong></div>"),i.next().hide(),u(".soliloquy-addon-error").delay(3e3).slideUp()}):(i.text(r.deactivate).removeClass("soliloquy-activate-addon").addClass("soliloquy-deactivate-addon"),o.text(r.active),t.removeClass("soliloquy-addon-inactive").addClass("soliloquy-addon-active"),i.next().hide())},error:function(e,t,o){i.next().hide()}});u.ajax(e)}),u("#soliloquy-addons-area").on("click.deactivateAddon",".soliloquy-deactivate-addon",function(e){e.preventDefault();var i=u(this),e=i.attr("rel"),t=i.parent().parent(),o=i.parent().parent().find(".addon-status").children("span"),e=(u(".soliloquy-addon-error").remove(),i.text(r.deactivating),i.next().css({display:"inline-block","margin-top":"0px"}),{url:ajaxurl,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"soliloquy_deactivate_addon",nonce:r.deactivate_nonce,plugin:e},success:function(e){e&&!0!==e?t.slideDown("normal",function(){u(this).after('<div class="soliloquy-addon-error"><strong>'+e.error+"</strong></div>"),i.next().hide(),u(".soliloquy-addon-error").delay(3e3).slideUp()}):(i.text(r.activate).removeClass("soliloquy-deactivate-addon").addClass("soliloquy-activate-addon"),o.text(r.inactive),t.removeClass("soliloquy-addon-active").addClass("soliloquy-addon-inactive"),i.next().hide())},error:function(e,t,o){i.next().hide()}});u.ajax(e)}),u("#soliloquy-addons-area").on("click.installAddon",".soliloquy-install-addon",function(e){e.preventDefault();var a=u(this),s=a.attr("rel"),n=a.parent().parent(),d=a.parent().parent().find(".addon-status").children("span"),e=(u(".soliloquy-addon-error").remove(),a.text(r.installing),a.next().css({display:"inline-block","margin-top":"0px"}),{url:ajaxurl,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"soliloquy_install_addon",nonce:r.install_nonce,plugin:s},success:function(e){e.error?n.slideDown("normal",function(){a.parent().parent().after('<div class="soliloquy-addon-error"><strong>'+e.error+"</strong></div>"),a.text(r.install),a.next().hide(),u(".soliloquy-addon-error").delay(4e3).slideUp()}):e.form?(n.slideDown("normal",function(){u(this).after('<div class="soliloquy-addon-error">'+e.form+"</div>"),a.next().hide()}),a.attr("disabled",!0),u("#soliloquy-addons-area").on("click.installCredsAddon","#upgrade",function(e){e.preventDefault(),a.next().hide(),u(this).val(r.installing),u(this).next().css({display:"inline-block","margin-top":"0px"});var e=u(this).parent().parent().find("#hostname").val(),t=u(this).parent().parent().find("#username").val(),o=u(this).parent().parent().find("#password").val(),i=u(this),l=u(this).parent().parent().parent().parent(),e={url:ajaxurl,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"soliloquy_install_addon",nonce:r.install_nonce,plugin:s,hostname:e,username:t,password:o},success:function(e){e.error?n.slideDown("normal",function(){a.parent().parent().after('<div class="soliloquy-addon-error"><strong>'+e.error+"</strong></div>"),a.text(r.install),a.next().hide(),u(".soliloquy-addon-error").delay(4e3).slideUp()}):e.form?(a.next().hide(),u(".soliloquy-inline-error").remove(),u(i).val(r.proceed),u(i).after('<span class="soliloquy-inline-error">'+r.connect_error+"</span>")):(u(l).remove(),a.show(),a.text(r.activate).removeClass("soliloquy-install-addon").addClass("soliloquy-activate-addon"),a.attr("rel",e.plugin),a.removeAttr("disabled"),d.text(r.inactive),n.removeClass("soliloquy-addon-not-installed").addClass("soliloquy-addon-inactive"),a.next().hide())},error:function(e,t,o){a.next().hide()}};u.ajax(e)})):(a.text(r.activate).removeClass("soliloquy-install-addon").addClass("soliloquy-activate-addon"),a.attr("rel",e.plugin),d.text(r.inactive),n.removeClass("soliloquy-addon-not-installed").addClass("soliloquy-addon-inactive"),a.next().hide())},error:function(e,t,o){a.next().hide()}});u.ajax(e)})})})(jQuery,(window,document,soliloquy_addons));